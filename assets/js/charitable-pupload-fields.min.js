/*!  1.4.0 2016-03-28 13:56 */
!function(a){function b(a){var b=a>1?CHARITABLE_UPLOAD_VARS.max_file_uploads_plural:CHARITABLE_UPLOAD_VARS.max_file_uploads_single;return b.replace("%d",a)}function c(a,b){a.fadeIn(300),a.children(".images").append('<li data-file-id="'+b.id+'" class="">'+b.name+"</li>")}function d(a,b){a.find("[data-file-id="+b.id+"]").remove(),a.find(".images li").length||a.hide()}function e(){var b=a(this).parent();return b.fadeOut(300,function(){this.remove()}),b.parent().siblings(".charitable-drag-drop-dropzone").fadeIn(300),!1}function f(a){a.removeClass("drag-over").fadeOut(300)}function g(a){var b=Math.floor(Math.log(a)/Math.log(1024));return 1*(a/Math.pow(1024,b)).toFixed(2)+" "+["B","kB","MB","GB","TB"][b]}function h(a,b,c,e){b.fadeIn(300),a.find("[data-file-id="+c.id+"]").addClass("error").text(e).delay(5e3).fadeOut(300,function(){d(a,c)})}a(".charitable-drag-drop").each(function(){var i,j,k=a(this),l=k.data("params"),m=a("#"+k.data("images")),n=k.find(".charitable-drag-drop-image-loader").first(),o=l.multipart_params.max_uploads,p=parseInt(k.data("max-size"),10),q=(-1!=navigator.userAgent.indexOf("Trident/")||-1!=navigator.userAgent.indexOf("MSIE "),b(o));j=new plupload.Uploader(l),i=a(j.settings.drop_element),j.init(),j.bind("PostInit",function(){i&&(i.addClass("supports-drag-drop"),i.bind("dragover",function(){i.addClass("drag-over")}),i.bind("dragleave",function(){i.removeClass("drag-over")}),k.on("click",".remove-image",e))}),j.bind("FilesAdded",function(a,b){var d=m.children().length;if(i.removeClass("drag-over"),o>0&&d+b.length>o){if(o>d){var e=o-d;a.splice(e-1,b.length-e),b=a.files}alert(q)}o>0&&d+b.length>=o&&f(i),plupload.each(b,function(b){c(n,b),b.size>=p&&(a.removeFile(b),h(n,i,b,CHARITABLE_UPLOAD_VARS.max_file_size.replace("%1$s",b.name).replace("%2$s",g(p))))}),a.refresh(),a.start()}),j.bind("Error",function(a,b){console.log(b)}),j.bind("FileUploaded",function(b,c,e){return e=a.parseJSON(e.response),e.success?(d(n,c),void m.append(e.data)):void h(n,i,c,CHARITABLE_UPLOAD_VARS.upload_problem.replace("%s",c.name))})})}(jQuery);