/*!  1.4.0 2016-03-23 19:13 */
!function(a){function b(a){var b=a>1?CHARITABLE_UPLOAD_VARS.max_file_uploads_plural:CHARITABLE_UPLOAD_VARS.max_file_uploads_single;return b.replace("%d",a)}function c(a,b){a.fadeIn(300),a.children(".images").append('<li data-file-id="'+b.id+'" class="">'+b.name+"</li>")}function d(a,b){a.find("[data-file-id="+b.id+"]").remove(),a.find(".images li").length||a.hide()}function e(){var b=a(this).parent();return b.fadeOut(300,function(){this.remove()}),b.parent().siblings(".charitable-drag-drop-dropzone").fadeIn(300),!1}function f(a){a.removeClass("drag-over").fadeOut(300)}function g(b){a("li#"+b.id).addClass("charitable-image-error").delay(1600).fadeOut("slow",function(){a(this).remove()})}a(".charitable-drag-drop").each(function(){var h,i,j=a(this),k=j.data("params"),l=a("#"+j.data("images")),m=j.find(".charitable-drag-drop-image-loader").first(),n=k.multipart_params.max_uploads,o=parseInt(j.data("max-size"),10),p=(-1!=navigator.userAgent.indexOf("Trident/")||-1!=navigator.userAgent.indexOf("MSIE "),b(n));i=new plupload.Uploader(k),h=a(i.settings.drop_element),i.init(),i.bind("PostInit",function(){h&&(h.addClass("supports-drag-drop"),h.bind("dragover",function(){h.addClass("drag-over")}),h.bind("dragleave",function(){h.removeClass("drag-over")}),j.on("click",".remove-image",e))}),i.bind("FilesAdded",function(a,b){var d=l.children().length;if(n>0&&d+b.length>n){if(n>d){var e=n-d;a.splice(e-1,b.length-e),b=a.files}alert(p)}n>0&&d+b.length>=n&&f(h),plupload.each(b,function(a){c(m,a),a.size>=o&&g(a)}),a.refresh(),a.start()}),i.bind("Error",function(a,b){console.log(b),console.log(a)}),i.bind("FileUploaded",function(b,c,e){e=a.parseJSON(e.response),e.success||console.log("error"),d(m,c),l.append(e.data)})})}(jQuery);