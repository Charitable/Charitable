/*!  1.4.0 2016-07-25 10:09 */
CHARITABLE=window.CHARITABLE||{},function(a,b){var c=function(a){this.errors=[],this.form=a;var c=this,d=b("body"),e=function(){b(this).closest("li").find("input[name=donation_amount]").prop("checked",!0).trigger("change"),d.off("focus","input.custom-donation-input",e),b(this).focus(),d.on("focus","input.custom-donation-input",e)},f=function(){var a=c.unformat_amount(b(this).val());b.trim(a)>0&&b(this).val(c.format_amount(a))},g=function(){var a=b(this).closest("li");a.hasClass("selected")||(a.parents("#charitable-donation-form").find(".donation-amount.selected").removeClass("selected"),a.addClass("selected"),a.hasClass("custom-donation-amount")&&a.find("input.custom-donation-input").focus())},h=function(){c.hide_inactive_payment_methods(),c.show_active_payment_methods(b(this).val())},i=function(){var a=b(this),c=a.serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{}),d=a.position(),e=a.parent("#charitable-donation-form-modal");return a.find(".charitable-form-processing").show(),c.action="make_donation",c.form_action=c.charitable_action,delete c.charitable_action,b.ajax({type:"POST",data:c,dataType:"json",url:CHARITABLE_VARS.ajaxurl,xhrFields:{withCredentials:!0},success:function(b){b.success&&(window.location.href=b.redirect_to),a.find(".charitable-form-processing").hide(),a.find(".charitable-form-errors").length&&a.find(".charitable-form-errors").remove(),a.prepend(b.errors),e.length?e.scrollTop(0):window.scrollTo(d.left,d.top)}}).fail(function(a,b,c){window.console&&window.console.log&&console.log(a),window.scrollTo(d.left,d.top)}).done(function(a){}),!1},j=function(){c.form.find(".donation-amount input:checked").each(function(){b(this).closest("li").addClass("selected")}),c.get_all_payment_methods().length&&(c.hide_inactive_payment_methods(),c.form.on("change","#charitable-gateway-selector input[name=gateway]",h))},k=function(){d.on("click",".donation-amount",g),d.on("focus","input.custom-donation-input",e),d.on("blur",".custom-donation-input",f),1===c.form.data("use-ajax")&&d.on("submit","#charitable-donation-form",i),CHARITABLE.forms_initialized=!0};j(),!1===CHARITABLE.forms_initialized&&k()};c.prototype.get_email=function(){return this.form.find("[name=email]").val()},c.prototype.get_amount=function(){var a=suggested=parseFloat(this.form.find("[name=donation_amount]:checked").val());return isNaN(suggested)&&(a=parseFloat(this.form.find("[name=custom_donation_amount]").val())),(isNaN(a)||0>=a)&&(a=0),a},c.prototype.get_description=function(){return this.form.find("[name=description]").val()||""},c.prototype.get_cc_number=function(){return this.form.find("#charitable_field_cc_number input").val()||""},c.prototype.get_cc_cvc=function(){return this.form.find("#charitable_field_cc_cvc input").val()||""},c.prototype.get_cc_expiry_month=function(){return this.form.find("#charitable_field_cc_expiration select.month").val()||""},c.prototype.get_cc_expiry_year=function(){return this.form.find("#charitable_field_cc_expiration select.year").val()||""},c.prototype.clear_cc_fields=function(){this.form.find("#charitable_field_cc_number input, #charitable_field_cc_name input, #charitable_field_cc_cvc input, #charitable_field_cc_expiration select").removeAttr("name")},c.prototype.get_payment_method=function(){return this.form.find("[type=hidden][name=gateway], [name=gateway]:checked").val()||""},c.prototype.get_all_payment_methods=function(){return this.form.find("#charitable-gateway-selector input[name=gateway]")},c.prototype.hide_inactive_payment_methods=function(){var a=this.get_payment_method();this.form.find(".charitable-gateway-fields[data-gateway!="+a+"]").hide()},c.prototype.show_active_payment_methods=function(a){var a=a||this.get_payment_method();this.form.find(".charitable-gateway-fields[data-gateway="+a+"]").show()},c.prototype.format_amount=function(a,b){return"undefined"==typeof b&&(b=""),accounting.formatMoney(a,{symbol:b,decimal:CHARITABLE_VARS.currency_format_decimal_sep,thousand:CHARITABLE_VARS.currency_format_thousand_sep,precision:CHARITABLE_VARS.currency_format_num_decimals,format:CHARITABLE_VARS.currency_format}).trim()},c.prototype.unformat_amount=function(a){return Math.abs(parseFloat(accounting.unformat(a,CHARITABLE_VARS.currency_format_decimal_sep)))},c.prototype.add_error=function(a){this.errors.push(a)},c.prototype.get_errors=function(){return this.errors},c.prototype.get_error_message=function(){return this.errors.join(" ")},c.prototype.is_valid_amount=function(){return this.get_amount()>0},c.prototype.validate=function(){var a=!0;return!1===this.is_valid_amount()&&(a=!1,this.add_error(CHARITABLE_VARS.error_invalid_amount)),a},a.Donation_Form=c}(CHARITABLE,jQuery),function(a,b){var c=function(){var a=function(){b("#"+b(this).data("charitable-toggle")).addClass("charitable-hidden")},c=function(){var a=b(this),c=a.data("charitable-toggle");return b("#"+c).toggleClass("charitable-hidden",a.is(":checked")),!1};return b("body").on("click","[data-charitable-toggle]",c),function(){b("[data-charitable-toggle]").each(a)}};a.Toggle=c()}(CHARITABLE,jQuery),function(a,b){}(CHARITABLE,jQuery),CHARITABLE.SanitizeURL=function(a){CHARITABLE.Helpers.sanitize_url(a)},function(a){CHARITABLE.forms_initialized=!1,a(document).ready(function(){var b=a("#charitable-donation-form");b.length&&new CHARITABLE.Donation_Form(b),CHARITABLE.Toggle()})}(jQuery);